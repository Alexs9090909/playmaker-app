{"ast":null,"code":"const apiKey = \"BQCkgDy6I7scm-6-2_O6kisSHV5Y41fDR83_fSgFk2phtbDghTqLI-tvHkGcgSgSgvsIdeNENhjqM5d7egjKrAc99y8haGPNUfVOPIpMK6Oxg174g6XoAfTqSc_htgI7xj5oNwTetlb1TAa0zdtK8VMedeeB1oVZa4PjRk4-1yAhOzIIsGTB31DEynXFdWpG5qatbLo4GbuUNqAmnQKOZJJBkAuaodEa9PimN3nai3Y-w6HX32XPrLABPDlI\"; // Access token à renouveler toutes les heures \n\nconst Spotify = {\n  search(term) {\n    return fetch(`https://api.spotify.com/v1/search?q=${term}&type=track`, {\n      headers: {\n        Authorization: `Bearer ${apiKey}`\n      }\n    }).then(response => {\n      return response.json();\n    }).then(jsonResponse => {\n      // console.log(jsonResponse);\n      // console.log('jsonResponse is an ' + typeof jsonResponse);\n      // console.log(jsonResponse.tracks)\n      // console.log(jsonResponse.tracks.items)\n      const items = jsonResponse.tracks.items;\n      // const arrayFromJson = Array.from(jsonResponse.tracks.items);\n\n      // console.log('arrayFromJson is an ' + typeof arrayFromJson);\n      // console.log('arrayFromJson is ' + typeof arrayFromJson);\n      // console.log(arrayFromJson);\n\n      // console.log(items[0]);\n      const itemsArray = Object.values(items);\n      // console.log(typeof itemsArray);\n      // console.log(itemsArray);\n      // console.log(typeof itemsArray);\n      // console.log(itemsArray);\n\n      /* const arrayFromJsonMap = items.map((track, index) => {\n          [index] = {\n              id: track.id,\n              name: track.name,\n              artist: track.artists[0].name,\n              album: track.album,\n              url: track.uri,\n          }\n      }) */\n\n      // console.log(arrayFromJsonMap);\n      return itemsArray;\n\n      /*\n      if (arrayFromJson) { // track est il bien le bon suffixe ?\n          return arrayFromJson.map((track) => ({\n              id: track.id,\n              name: track.name,\n              artist: track.artist,\n              album: track.album,\n              url: track.url,\n          }))\n      } */\n    });\n  },\n\n  save(playlistTitle, playlistTracks) {\n    return fetch(`https://api.spotify.com/v1/me`, {\n      headers: {\n        Authorization: `Bearer ${apiKey}`\n      }\n    }).then(response => {\n      return response.json();\n    }).then(jsonResponse => {\n      // console.log(typeof jsonResponse)\n      // console.log(jsonResponse);\n      const user_id = jsonResponse.id;\n      // console.log(user_id);\n\n      // Deuxième fetch (exemple de fetch POST)\n      return fetch(`https://api.spotify.com/v1/users/${user_id}/playlists`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${apiKey}`\n        },\n        body: JSON.stringify({\n          \"name\": `${playlistTitle}`,\n          \"description\": \"New playlist description\",\n          \"public\": false\n        })\n      }).then(secondResponse => {\n        // Gérer la réponse du deuxième fetch\n        if (secondResponse.ok) {\n          console.log(secondResponse.json());\n          const playlist_id = secondResponse.json()[2].id;\n          console.log('playlist id is ' + playlist_id);\n          // console.log(typeof secondResponse.json);\n          return fetch(`https://api.spotify.com/v1/users/${user_id}/playlists/${playlist_id}/tracks`, {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n              Authorization: `Bearer ${apiKey}`\n            },\n            body: JSON.stringify({\n              \"name\": `${playlistTitle}`,\n              \"description\": \"New playlist description\",\n              \"public\": false\n            })\n          }).then(secondResponse => {\n            // Gérer la réponse du deuxième fetch\n            if (secondResponse.ok) {\n              // console.log(typeof secondResponse.json);\n              return 'fake return';\n            }\n            // throw new Error('Request failed man!');\n          }, networkError => console.log(networkError.message)).then(jsonResponse => {\n            // console.log(jsonResponse);\n          });\n        }\n        // throw new Error('Request failed man!');\n      }, networkError => console.log(networkError.message)).then(jsonResponse => {\n        // console.log(jsonResponse);\n      });\n    }).catch(error => {\n      console.error('Erreur lors de la requête man :', error);\n    });\n  }\n};\nexport default Spotify;\n\n/*\n\nhttp://localhost:3000/#access_token=\n\nBQDGp8ePY_W94-iXqYTAqz6v5a3acWQCst4nlhgk_m4yAqJW_vVZ2Dr--z529lNq7w3Fa-vesRYxrpOYdDDZb9h9bcJgvCwZCOLhhCDsoqu3Hti9FHideF4pKcCy0JyvfycAlhsGYkoW7V-zwLd1pDVm5OaiBFnQXDWgEiTySlw3iIDsYlplFPeHre-B2c5-Fn8bIuOwYkkXhYeWAU-laT58JxF4B0fdSUNQRqLAFs2QnnZSgg8\n\n&token_type=Bearer&expires_in=3600&state=4viLWhgqbWECpVP5\n\n\n\nhttp://localhost:3000/#access_token=\n\nBQCkgDy6I7scm-6-2_O6kisSHV5Y41fDR83_fSgFk2phtbDghTqLI-tvHkGcgSgSgvsIdeNENhjqM5d7egjKrAc99y8haGPNUfVOPIpMK6Oxg174g6XoAfTqSc_htgI7xj5oNwTetlb1TAa0zdtK8VMedeeB1oVZa4PjRk4-1yAhOzIIsGTB31DEynXFdWpG5qatbLo4GbuUNqAmnQKOZJJBkAuaodEa9PimN3nai3Y-w6HX32XPrLABPDlI\n\n&token_type=Bearer&expires_in=3600&state=zHTL5QnoFFY5hZ5Z\n\n*/","map":{"version":3,"names":["apiKey","Spotify","search","term","fetch","headers","Authorization","then","response","json","jsonResponse","items","tracks","itemsArray","Object","values","save","playlistTitle","playlistTracks","user_id","id","method","body","JSON","stringify","secondResponse","ok","console","log","playlist_id","networkError","message","catch","error"],"sources":["/Users/alexandresuteau/Desktop/CODE/CODECADEMY/07_Create a Front-End APP with React/99_PROJECT_Jammming/jammming/src/utils/Spotify.js"],"sourcesContent":["const apiKey = \"BQCkgDy6I7scm-6-2_O6kisSHV5Y41fDR83_fSgFk2phtbDghTqLI-tvHkGcgSgSgvsIdeNENhjqM5d7egjKrAc99y8haGPNUfVOPIpMK6Oxg174g6XoAfTqSc_htgI7xj5oNwTetlb1TAa0zdtK8VMedeeB1oVZa4PjRk4-1yAhOzIIsGTB31DEynXFdWpG5qatbLo4GbuUNqAmnQKOZJJBkAuaodEa9PimN3nai3Y-w6HX32XPrLABPDlI\" // Access token à renouveler toutes les heures \n\nconst Spotify = {\n    search(term) {\n        return fetch(\n            `https://api.spotify.com/v1/search?q=${term}&type=track`,\n            {\n                headers: {\n                    Authorization: `Bearer ${apiKey}`\n                },\n            }\n\n        )\n            .then((response) => {\n                return response.json();\n            })\n            .then((jsonResponse) => {\n\n                // console.log(jsonResponse);\n                // console.log('jsonResponse is an ' + typeof jsonResponse);\n                // console.log(jsonResponse.tracks)\n                // console.log(jsonResponse.tracks.items)\n                const items = jsonResponse.tracks.items;\n                // const arrayFromJson = Array.from(jsonResponse.tracks.items);\n\n                // console.log('arrayFromJson is an ' + typeof arrayFromJson);\n                // console.log('arrayFromJson is ' + typeof arrayFromJson);\n                // console.log(arrayFromJson);\n\n                // console.log(items[0]);\n                const itemsArray = Object.values(items);\n                // console.log(typeof itemsArray);\n                // console.log(itemsArray);\n                // console.log(typeof itemsArray);\n                // console.log(itemsArray);\n\n                /* const arrayFromJsonMap = items.map((track, index) => {\n                    [index] = {\n                        id: track.id,\n                        name: track.name,\n                        artist: track.artists[0].name,\n                        album: track.album,\n                        url: track.uri,\n                    }\n                }) */\n\n                // console.log(arrayFromJsonMap);\n                return itemsArray;\n\n\n\n                /*\n                if (arrayFromJson) { // track est il bien le bon suffixe ?\n                    return arrayFromJson.map((track) => ({\n                        id: track.id,\n                        name: track.name,\n                        artist: track.artist,\n                        album: track.album,\n                        url: track.url,\n                    }))\n                } */\n            })\n    },\n\n    save(playlistTitle, playlistTracks) {\n        return fetch(\n            `https://api.spotify.com/v1/me`,\n            {\n                headers: {\n                    Authorization: `Bearer ${apiKey}`\n                },\n            }\n        )\n            .then((response) => {\n                return response.json();\n            })\n            .then((jsonResponse) => {\n                // console.log(typeof jsonResponse)\n                // console.log(jsonResponse);\n                const user_id = jsonResponse.id;\n                // console.log(user_id);\n\n                // Deuxième fetch (exemple de fetch POST)\n                return fetch(\n                    `https://api.spotify.com/v1/users/${user_id}/playlists`,\n                    {\n                        method: 'POST',\n                        headers: {\n                            'Content-Type': 'application/json',\n                            Authorization: `Bearer ${apiKey}`\n                        },\n                        body: JSON.stringify({\n                            \"name\": `${playlistTitle}`,\n                            \"description\": \"New playlist description\",\n                            \"public\": false\n                        }),\n                    }\n                )\n                .then((secondResponse) => {\n                    // Gérer la réponse du deuxième fetch\n                    if (secondResponse.ok) {\n                        console.log(secondResponse.json())\n                        const playlist_id = secondResponse.json()[2].id;\n                        console.log('playlist id is '+ playlist_id);\n                    // console.log(typeof secondResponse.json);\n                    return fetch(\n                        `https://api.spotify.com/v1/users/${user_id}/playlists/${playlist_id}/tracks`,\n                        {\n                            method: 'POST',\n                            headers: {\n                                'Content-Type': 'application/json',\n                                Authorization: `Bearer ${apiKey}`\n                            },\n                            body: JSON.stringify({\n                                \"name\": `${playlistTitle}`,\n                                \"description\": \"New playlist description\",\n                                \"public\": false\n                            }),\n                        }\n                    )\n                    .then((secondResponse) => {\n                        // Gérer la réponse du deuxième fetch\n                        if (secondResponse.ok) {\n                        // console.log(typeof secondResponse.json);\n                        return 'fake return';\n                    }\n                    // throw new Error('Request failed man!');\n                    }, networkError => console.log(networkError.message)\n                    ).then(jsonResponse => {\n                        // console.log(jsonResponse);\n                    })\n                    \n                    \n                    \n                    \n                    \n                    ;\n                }\n                // throw new Error('Request failed man!');\n                }, networkError => console.log(networkError.message)\n                ).then(jsonResponse => {\n                    // console.log(jsonResponse);\n                })\n                ;\n            })\n\n            .catch((error) => {\n                console.error('Erreur lors de la requête man :', error);\n            });\n    }\n}\n\n\nexport default Spotify;\n\n\n\n/*\n\nhttp://localhost:3000/#access_token=\n\nBQDGp8ePY_W94-iXqYTAqz6v5a3acWQCst4nlhgk_m4yAqJW_vVZ2Dr--z529lNq7w3Fa-vesRYxrpOYdDDZb9h9bcJgvCwZCOLhhCDsoqu3Hti9FHideF4pKcCy0JyvfycAlhsGYkoW7V-zwLd1pDVm5OaiBFnQXDWgEiTySlw3iIDsYlplFPeHre-B2c5-Fn8bIuOwYkkXhYeWAU-laT58JxF4B0fdSUNQRqLAFs2QnnZSgg8\n\n&token_type=Bearer&expires_in=3600&state=4viLWhgqbWECpVP5\n\n\n\nhttp://localhost:3000/#access_token=\n\nBQCkgDy6I7scm-6-2_O6kisSHV5Y41fDR83_fSgFk2phtbDghTqLI-tvHkGcgSgSgvsIdeNENhjqM5d7egjKrAc99y8haGPNUfVOPIpMK6Oxg174g6XoAfTqSc_htgI7xj5oNwTetlb1TAa0zdtK8VMedeeB1oVZa4PjRk4-1yAhOzIIsGTB31DEynXFdWpG5qatbLo4GbuUNqAmnQKOZJJBkAuaodEa9PimN3nai3Y-w6HX32XPrLABPDlI\n\n&token_type=Bearer&expires_in=3600&state=zHTL5QnoFFY5hZ5Z\n\n*/"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}